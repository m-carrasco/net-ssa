set(QUERY_SRC_DIRECTORY ${CMAKE_SOURCE_DIR}/souffle/src)
set(QUERY_INPUT_FILE ${QUERY_SRC_DIRECTORY}/ssa-query.dl)

set(SOUFFLE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin/souffle)
set(QUERY_OUTPUT_EXECUTABLE ${SOUFFLE_OUTPUT_DIRECTORY}/ssa-query PARENT_SCOPE)

file(MAKE_DIRECTORY ${SOUFFLE_OUTPUT_DIRECTORY})

add_custom_target(souffle
    COMMAND ${SOUFFLE_COMMAND} --dl-program=${QUERY_OUTPUT_EXECUTABLE} --include-dir=${QUERY_SRC_DIRECTORY} ${QUERY_INPUT_FILE}
    WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}
    )